webpackJsonp([14],{UPH7:function(e,t,n){"use strict";function s(e){n("qJD2")}Object.defineProperty(t,"__esModule",{value:!0});var i=n("gt+Q"),a=n("hCGe"),l={data:function(){return{api:{list:!1},changeOptions:[],options:[],props:{label:"name",value:"name",children:"children"},selectedOptions:[],oldSelectedOptions:[],multipleSelection:[],currentPage:1,totalCount:0,pageSize:10,condition:{},tableData:[],regions:[]}},methods:{handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.currentPage=e,this.queryTaskList()},queryTaskList:function(e,t,n,s){var a=this,l={isPage:this.isPage,currentPage:this.currentPage,pagesize:this.pageSize};e&&t&&n&&s&&(l.project=e,l.cluster=t,l.service=n,l.version=s),Object(i.h)(l).then(function(e){if(0===e.code){if(a.totalCount=e.data.totalCount,a.currentPage=e.data.currentPage,a.tableData=e.data.list,e.data.condition){var t=JSON.parse(e.data.condition);a.condition=t;var n=a.options.filter(function(e){return e.name===t.project});if(n[0]&&n[0].children&&n[0].children.length>0){var s=n[0].children.filter(function(e){return e.name===t.cluster});if(s[0]&&s[0].children&&s[0].children.length>0){var i=s[0].children.filter(function(e){return e.name===t.service});i[0]&&i[0].children&&i[0].children.length>0?i[0].children.map(function(e){e.name===t.version&&(a.versionId=e.id,a.oldSelectedOptions=[],a.oldSelectedOptions.push(t.project,t.cluster,t.service,t.version),a.selectedOptions=a.oldSelectedOptions.slice(0))}):a.selectedOptions=[]}else a.selectedOptions=[]}else a.selectedOptions=[]}0===a.selectedOptions.length&&(a.tableData=[],a.totalCount="")}else a.$message({message:e.message,type:"error"})})},confirmDelTask:function(e){var t=this,n=null;n=e?i.d:i.b;var s={};if(e)s.id=e.id;else{var a=[];this.multipleSelection.map(function(e){a.push(e.id)}),s.ids=a}this.$confirm("此操作将删除选中推送痕迹, 是否继续?","提示",{cancelButtonText:"取 消",confirmButtonText:"确 定",type:"warning"}).then(function(){n(s).then(function(e){0===e.code?(t.$message({message:e.message,type:"success"}),t.queryTaskList()):t.$message({message:e.message,type:"error"})})})},handleChange:function(){var e=this.selectedOptions[0]?this.selectedOptions[0]:"",t=this.selectedOptions[1]?this.selectedOptions[1]:"",n=this.selectedOptions[2]?this.selectedOptions[2]:"",s=this.selectedOptions[3]?this.selectedOptions[3]:"";1===this.selectedOptions.length&&(this.$message({message:"请为该项目创建集群",type:"warning"}),this.selectedOptions=this.oldSelectedOptions.slice(0)),2===this.selectedOptions.length&&(this.$message({message:"请为该集群创建服务",type:"warning"}),this.selectedOptions=this.oldSelectedOptions.slice(0)),3===this.selectedOptions.length&&(this.$message({message:"请为该服务创建版本",type:"warning"}),this.selectedOptions=this.oldSelectedOptions.slice(0)),e&&t&&n&&s&&this.queryTaskList(e,t,n,s)},initSelectedOptions:function(){var e=this;this.api.list=!0,Object(a.S)().then(function(t){if(0===t.code){if(e.api.list=!1,e.changeOptions=t.data.list,t.data.list&&t.data.list.length>0){var n=[];t.data.list.map(function(e){var t={};if(t.name=e.name,t.id=e.id,e.children){var s=[];e.children.map(function(e){var t={};if(t.name=e.name,t.id=e.id,e.children){var n=[];e.children.map(function(e){var t={};if(t.name=e.name,t.id=e.id,e.children){var s=[];e.children.map(function(e){var t={};t.name=e.name,t.id=e.id,s.push(t)}),t.children=s}n.push(t)}),t.children=n}s.push(t)}),t.children=s}n.push(t)}),e.options=n,e.optionsCluster=n}e.queryTaskList()}else e.$message({message:t.message,type:"error"})})}},created:function(){this.initSelectedOptions()}},r=function(){var e=this,t=this,n=t.$createElement,s=t._self._c||n;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.api.list,expression:"api.list"}],staticClass:"server_list",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[s("ul",{staticClass:"nav-list clearfix"},[s("router-link",{attrs:{tag:"li",to:"/main/track_config"}},[t._v("配置推送轨迹")]),t._v(" "),s("li",{staticClass:"track"},[t._v("服务推送轨迹")])],1),t._v(" "),s("div",{staticClass:"deal clearfix"},[s("div",{staticClass:"basebtn l"},[s("button",{class:[{disable:!t.multipleSelection.length},{active:t.multipleSelection.length}],attrs:{disabled:!t.multipleSelection.length},on:{click:function(e){t.confirmDelTask()}}},[t._v("批量删除")])]),t._v(" "),s("div",{staticClass:"r"},[s("el-cascader",{ref:"cascader",attrs:{placeholder:"请输入关键字",filterable:"",options:t.options,props:t.props,cascaderTitle:["项目","集群","服务","API版本"]},on:{change:t.handleChange},model:{value:t.selectedOptions,callback:function(e){t.selectedOptions=e},expression:"selectedOptions"}})],1)]),t._v(" "),s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.tableData},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"54"}}),t._v(" "),s("el-table-column",{attrs:{prop:"id",label:"推送ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("router-link",{staticClass:"lan",attrs:{tag:"a",to:"/main/track_discovery_detail?pushId="+e.row.id}},[t._v(t._s(e.row.id))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"项目"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.condition.project))]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"集群"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.condition.cluster))]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"服务"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.condition.service))]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"regions",label:"结果"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.regions,function(e,n){return s("div",{key:n,staticClass:"clearfix"},[s("div",{staticClass:"l"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"l",class:{"green-bg":e.successed,"red-bg":-1===e.successed}},[t._v("["+t._s(1===e.successed?"成功":"失败")+"]")])])})}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"pushTime",label:"推送时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(new Date(e.row.pushTime).Format("yyyy-MM-dd hh:mm:ss")))]}}])}),t._v(" "),s("div",{attrs:{slot:"empty"},slot:"empty"},[0==this.selectedOptions.length?s("a",{staticClass:"lan",on:{click:function(){e.$refs.cascader.handleClick()}}},[t._v("输入关键字筛选查看内容")]):s("p",[t._v("暂无数据")])])],1)],1),t._v(" "),t.totalCount>t.pageSize?s("div",{staticClass:"basePagenate"},[s("el-pagination",{attrs:{"page-size":t.pageSize,"current-page":t.currentPage,total:t.totalCount,layout:"prev, pager, next"},on:{"current-change":t.handleCurrentChange}})],1):t._e()])},o=[],c={render:r,staticRenderFns:o},d=c,p=n("VU/8"),f=s,u=p(l,d,!1,f,"data-v-78d0ff46",null);t.default=u.exports},q53f:function(e,t,n){t=e.exports=n("FZ+f")(!0),t.push([e.i,".server_list[data-v-78d0ff46]{padding:20px;min-width:1160px}.server_list .nav-list[data-v-78d0ff46]{border-bottom:1px solid #cbcbcb;margin-bottom:10px}.server_list .nav-list li[data-v-78d0ff46]{font-size:14px;line-height:30px;width:138px;float:left;margin:0 10px -1px 0;text-align:center;cursor:pointer;border:1px solid #cbcbcb;color:#333;background:#f3f5f9}.server_list .nav-list li.track[data-v-78d0ff46]{line-height:29px;border-top:2px solid #4285f4;border-bottom-color:#fff;font-weight:700;background:#fff}.server_list .deal[data-v-78d0ff46]{margin:20px 0 10px}.server_list .deal .el-cascader[data-v-78d0ff46]{width:280px}.server_list .el-table .lan[data-v-78d0ff46]{cursor:pointer}.server_list .el-table .green-bg[data-v-78d0ff46]{color:green}.server_list .el-table .red-bg[data-v-78d0ff46]{color:red}","",{version:3,sources:["D:/admin/config/src/components/track_config/track_discovery.vue"],names:[],mappings:"AACA,8BACE,aAAc,AACd,gBAAkB,CACnB,AACD,wCACE,gCAAiC,AACjC,kBAAoB,CACrB,AACD,2CACE,eAAgB,AAChB,iBAAkB,AAClB,YAAa,AACb,WAAY,AACZ,qBAAsB,AACtB,kBAAmB,AACnB,eAAgB,AAChB,yBAA0B,AAC1B,WAAY,AACZ,kBAAoB,CACrB,AACD,iDACE,iBAAkB,AAClB,6BAA8B,AAC9B,yBAA0B,AAC1B,gBAAkB,AAClB,eAAiB,CAClB,AACD,oCACE,kBAAoB,CACrB,AACD,iDACE,WAAa,CACd,AACD,6CACE,cAAgB,CACjB,AACD,kDACE,WAAe,CAChB,AACD,gDACE,SAAY,CACb",file:"track_discovery.vue",sourcesContent:["\n.server_list[data-v-78d0ff46] {\n  padding: 20px;\n  min-width: 1160px;\n}\n.server_list .nav-list[data-v-78d0ff46] {\n  border-bottom: 1px solid #cbcbcb;\n  margin-bottom: 10px;\n}\n.server_list .nav-list li[data-v-78d0ff46] {\n  font-size: 14px;\n  line-height: 30px;\n  width: 138px;\n  float: left;\n  margin: 0 10px -1px 0;\n  text-align: center;\n  cursor: pointer;\n  border: 1px solid #cbcbcb;\n  color: #333;\n  background: #f3f5f9;\n}\n.server_list .nav-list li.track[data-v-78d0ff46] {\n  line-height: 29px;\n  border-top: 2px solid #4285f4;\n  border-bottom-color: #fff;\n  font-weight: bold;\n  background: #fff;\n}\n.server_list .deal[data-v-78d0ff46] {\n  margin: 20px 0 10px;\n}\n.server_list .deal .el-cascader[data-v-78d0ff46] {\n  width: 280px;\n}\n.server_list .el-table .lan[data-v-78d0ff46] {\n  cursor: pointer;\n}\n.server_list .el-table .green-bg[data-v-78d0ff46] {\n  color: #008000;\n}\n.server_list .el-table .red-bg[data-v-78d0ff46] {\n  color: #f00;\n}"],sourceRoot:""}])},qJD2:function(e,t,n){var s=n("q53f");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);n("rjj0")("1cb012f9",s,!0)}});
//# sourceMappingURL=14.8ed7e89c5c4782ef27ce.js.map